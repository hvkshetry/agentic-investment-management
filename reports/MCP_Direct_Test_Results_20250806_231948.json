{
  "data_pipeline": {
    "fetch_equity_data": {
      "status": "success",
      "quality_score": 0.891
    },
    "get_risk_free_rate": {
      "status": "success",
      "rate": 0.042199999999999994
    },
    "prepare_for_optimization": {
      "status": "success",
      "matrices_available": [
        "sample",
        "ledoit_wolf",
        "exp_weighted"
      ]
    }
  },
  "risk_server": {
    "get_risk_free_rate": {
      "status": "success",
      "result": {
        "rate": 0.042199999999999994,
        "annualized": true,
        "maturity": "10y",
        "source": "OpenBB/FRED",
        "confidence": 0.95,
        "fetch_time": "2025-08-06T23:19:42.260015"
      }
    },
    "analyze_portfolio_risk": {
      "status": "failed",
      "error": "Risk analysis failed: Unable to fetch risk-free rate for 10y: OpenBB is required for fetching risk-free rates. Install with: pip install openbb"
    }
  },
  "portfolio_server": {
    "optimize_portfolio_advanced": {
      "status": "success",
      "result": {
        "optimization_summary": {
          "total_methods_attempted": 3,
          "successful_optimizations": 3.0,
          "best_sharpe_portfolio": "HRP",
          "libraries_used": [
            "PyPortfolioOpt",
            "Riskfolio-Lib"
          ],
          "advanced_features": [
            "Ledoit-Wolf shrinkage",
            "Hierarchical Risk Parity",
            "Black-Litterman model",
            "13+ risk measures",
            "CVaR optimization",
            "Risk parity"
          ]
        },
        "optimal_portfolios": {
          "HRP": {
            "method": "Hierarchical Risk Parity",
            "weights": {
              "AGG": 0.82342,
              "GLD": 0.07704,
              "SPY": 0.04808,
              "VNQ": 0.05146
            },
            "expected_return": 0.08540805328249088,
            "volatility": 0.06969345164387535,
            "sharpe_ratio": 0.6199729280632924,
            "optimization_success": true,
            "note": "Robust to estimation error, no matrix inversion"
          }
        },
        "risk_analytics": {
          "HRP": {
            "VaR_95": -0.24098331681640434,
            "CVaR_95": -0.31378961092575275,
            "max_drawdown": -0.06766770938045225,
            "downside_deviation": 0.09650290564598736,
            "skewness": -0.09044290214032481,
            "kurtosis": 1.0776263354937243
          }
        },
        "discrete_allocation": {},
        "confidence": {
          "overall_score": 1.0,
          "components": {
            "data_quality": 0.455,
            "sample_adequacy": 0.455,
            "model_stability": 1.0,
            "parameter_certainty": 1.0
          },
          "warnings": [],
          "methodology": "Covariance: ledoit_wolf, Optimization: converged",
          "libraries_available": {
            "PyPortfolioOpt": true,
            "Riskfolio-Lib": true
          }
        },
        "metadata": {
          "timestamp": "2025-08-06T23:19:48.632366",
          "tickers": [
            "SPY",
            "AGG",
            "GLD",
            "VNQ"
          ],
          "lookback_days": 504,
          "sample_size": 344,
          "risk_free_rate": 0.042199999999999994,
          "optimization_methods": [
            "HRP",
            "min_volatility",
            "max_sharpe"
          ],
          "shrinkage_intensity": 0
        }
      }
    }
  },
  "tax_server": {
    "calculate_comprehensive_tax": {
      "status": "partial",
      "result": {
        "tax_summary": {
          "gross_income": 235000.0,
          "adjusted_gross_income": 85000.0,
          "total_deductions": 24600.0,
          "taxable_income": 60400.0,
          "federal_tax": 5725.25,
          "state_tax": 3787.0,
          "niit_tax": 0.0,
          "amt": 0.0,
          "total_credits": 0.0,
          "total_tax": 9512.25,
          "after_tax_income": 225487.75
        },
        "federal_tax": {},
        "state_tax": {},
        "niit_calculation": {
          "magi": 85000.0,
          "threshold": 200000.0,
          "excess_magi": 0.0,
          "net_investment_income": 85000.0,
          "niit_base": 0.0,
          "niit_tax": 0.0,
          "effective_niit_rate": 0.0
        },
        "amt_calculation": {
          "amt_income": 85000.0,
          "amt_exemption": 85700,
          "tentative_amt": 0.0,
          "regular_tax": 5725.25,
          "amt_owed": 0.0,
          "is_amt_liable": false
        },
        "trust_tax": {},
        "marginal_analysis": {
          "ordinary": {
            "additional_income": 10000,
            "marginal_tax": 2200.0,
            "marginal_rate": 22.0,
            "keep_after_tax": 7800.0
          },
          "ltcg": {
            "additional_income": 10000,
            "marginal_tax": 2200.0,
            "marginal_rate": 22.0,
            "keep_after_tax": 7800.0
          },
          "stcg": {
            "additional_income": 10000,
            "marginal_tax": 2200.0,
            "marginal_rate": 22.0,
            "keep_after_tax": 7800.0
          }
        },
        "effective_rates": {
          "federal_effective_rate": 2.4362765957446806,
          "state_effective_rate": 1.6114893617021275,
          "total_effective_rate": 4.047765957446808,
          "marginal_federal_rate": 22.0,
          "capital_gains_rate": 15.0
        },
        "tax_planning": {
          "recommendations": [],
          "total_potential_savings": 0
        },
        "confidence": {
          "overall_score": 0.557,
          "components": {
            "data_quality": 0.25,
            "sample_adequacy": 1.0,
            "model_stability": 1.0,
            "parameter_certainty": 0.4
          },
          "warnings": [
            "Incomplete data: 75.0% missing",
            "Not handling: wash_sales, qualified_dividends, trust_income",
            "Consider professional tax advice for verification"
          ],
          "methodology": "Tax complexity: complex"
        },
        "metadata": {
          "calculation_timestamp": "2025-08-06T23:19:48.985888",
          "tax_year": 2024,
          "entity_type": "individual",
          "filing_status": "Single",
          "state": "CA",
          "features_included": {
            "niit": true,
            "amt": true,
            "trust_tax": false,
            "state_specific": true
          },
          "tax_engine": "tenforty + custom calculations"
        }
      }
    }
  }
}